<?php
namespace JosephG\Roko\Domain\Security\KnownVulnerabilities\Entity;

/**
 * Entity representing a collection of vulnerabilities.
 */
final class VulnerabilityCollection {

	/** @var Vulnerability[] */
	private $vulnerabilities;

	private $title       = '';
	private $description = '';

	/**
	 * @param Vulnerability[] $vulnerabilities
	 */
	public function __construct( array $vulnerabilities ) {
		$this->vulnerabilities = $vulnerabilities;
	}

	public function setSectionSummary( $title, $description ) {
		$this->title       = $title;
		$this->description = $description;
	}

	public function getSectionSummary() {
		return array(
			'title'       => $this->title,
			'description' => $this->description,
		);
	}

	/**
	 * Get the vulnerabilities array.
	 *
	 * @return Vulnerability[]
	 */
	public function getVulnerabilities() {
		return $this->vulnerabilities;
	}

	/**
	 * Get count of vulnerabilities.
	 *
	 * @return int
	 */
	public function getCount() {
		return count( $this->vulnerabilities );
	}

	/**
	 * Check if any vulnerabilities exist.
	 *
	 * @return bool
	 */
	public function hasVulnerabilities() {
		return ! empty( $this->vulnerabilities );
	}
}
