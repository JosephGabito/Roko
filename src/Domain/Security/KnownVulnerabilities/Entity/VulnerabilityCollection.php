<?php
namespace JosephG\Roko\Domain\Security\KnownVulnerabilities\Entity;

/**
 * Entity representing a collection of vulnerabilities.
 */
final class VulnerabilityCollection {

	private $title       = '';
	private $description = '';

	/**
	 * @param Vulnerability[] $vulnerabilities
	 */
	public function __construct(
		private array $vulnerabilities
	) {}

	public function setSectionSummary( string $title, string $description ) {
		$this->title       = $title;
		$this->description = $description;
	}

	public function getSectionSummary(): array {
		return array(
			'title'       => $this->title,
			'description' => $this->description,
		);
	}

	/**
	 * Get the vulnerabilities array.
	 *
	 * @return Vulnerability[]
	 */
	public function getVulnerabilities(): array {
		return $this->vulnerabilities;
	}

	/**
	 * Get count of vulnerabilities.
	 *
	 * @return int
	 */
	public function getCount(): int {
		return count( $this->vulnerabilities );
	}

	/**
	 * Check if any vulnerabilities exist.
	 *
	 * @return bool
	 */
	public function hasVulnerabilities(): bool {
		return ! empty( $this->vulnerabilities );
	}
}
